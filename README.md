# Alou Rust - é«˜æ€§èƒ½AIæ™ºèƒ½ä½“

è¿™æ˜¯Alou3é¡¹ç›®çš„Rustè¯­è¨€é‡æ–°å®ç°ç‰ˆæœ¬ï¼Œæä¾›æ›´å¿«çš„è¿è¡Œé€Ÿåº¦å’Œæ›´å¥½çš„æ€§èƒ½ã€‚è¯¥é¡¹ç›®æ˜¯ä¸€ä¸ªåœ¨ç»ˆç«¯è¿è¡Œçš„AIæ™ºèƒ½ä½“ï¼Œæ”¯æŒMCPå·¥å…·é›†æˆå’ŒDeepSeek APIã€‚

## âœ¨ æœ€æ–°æ›´æ–°

- **âœ… æ¶æ„é‡æ„**ï¼šä»å¤æ‚çš„McpAgenté‡æ„ä¸ºç®€åŒ–çš„Adapteræ¶æ„
- **âœ… ä»£ç ç®€åŒ–**ï¼šä»£ç é‡ä»~1468è¡Œå‡å°‘åˆ°~240è¡Œï¼ˆå‡å°‘83%ï¼‰
- **âœ… DeepSeek APIé›†æˆ**ï¼šç›´æ¥HTTPè°ƒç”¨DeepSeek APIï¼Œæå‡å“åº”é€Ÿåº¦
- **âœ… æ€§èƒ½ä¼˜åŒ–**ï¼šç§»é™¤å¤æ‚é€»è¾‘ï¼Œä¸“æ³¨æ ¸å¿ƒåŠŸèƒ½
- **âœ… å·¥å…·è°ƒç”¨ä¿®å¤**ï¼šå®Œå…¨ä¿®å¤äº†æ™ºèƒ½ä½“å·¥å…·è°ƒç”¨è§£æå’Œæ‰§è¡Œé€»è¾‘
- **âœ… åå°åŠ è½½ä¼˜åŒ–**ï¼šå®ç°äº†é™é»˜çš„åå°MCPæœåŠ¡å™¨åŠ è½½ï¼Œæå‡å¯åŠ¨é€Ÿåº¦
- **âœ… Windowså…¼å®¹æ€§**ï¼šä¼˜åŒ–äº†Windowsç³»ç»Ÿä¸‹çš„MCPæœåŠ¡å™¨é…ç½®
- **âœ… æ™ºèƒ½ç›®å½•è®¿é—®**ï¼šæ”¯æŒå¤šç›®å½•é…ç½®å’Œæ™ºèƒ½è·¯å¾„è§£æ

## ğŸš€ æ ¸å¿ƒç‰¹æ€§

### æ™ºèƒ½ä½“æ¶æ„
- **å¤šæ¨¡æ€æ™ºèƒ½ä½“**ï¼šæ”¯æŒæ–‡ä»¶æ“ä½œã€ç½‘ç»œè¯·æ±‚ã€è®°å¿†ç®¡ç†ç­‰å¤šç§å·¥å…·
- **ä¸Šä¸‹æ–‡æ„ŸçŸ¥**ï¼šæ™ºèƒ½å·¥ä½œåŒºæ£€æµ‹ï¼Œè‡ªåŠ¨è¯†åˆ«é¡¹ç›®ç»“æ„å’Œç¯å¢ƒ
- **å·¥å…·å‘ç°**ï¼šè‡ªåŠ¨å‘ç°å’Œé›†æˆMCPæœåŠ¡å™¨æä¾›çš„å·¥å…·
- **è¿æ¥æ± ç®¡ç†**ï¼šé«˜æ•ˆçš„MCPæœåŠ¡å™¨è¿æ¥æ± ï¼Œæ”¯æŒå¤šæœåŠ¡å™¨å¹¶å‘
- **åå°åŠ è½½**ï¼šé™é»˜çš„åå°MCPæœåŠ¡å™¨åŠ è½½ï¼Œæå‡ç”¨æˆ·ä½“éªŒ
- **æ™ºèƒ½å·¥å…·è°ƒç”¨**ï¼šå®Œæ•´çš„å·¥å…·è°ƒç”¨è§£æå’Œæ‰§è¡Œæœºåˆ¶

### DeepSeeké›†æˆ
- **APIå®¢æˆ·ç«¯**ï¼šå®Œæ•´çš„DeepSeek APIé›†æˆ
- **æ™ºèƒ½æç¤º**ï¼šåŸºäºå·¥ä½œåŒºä¸Šä¸‹æ–‡çš„åŠ¨æ€ç³»ç»Ÿæç¤ºç”Ÿæˆ
- **å¯¹è¯ç®¡ç†**ï¼šæ”¯æŒå¤šè½®å¯¹è¯å’Œä¸Šä¸‹æ–‡ä¿æŒ
- **å·¥å…·è°ƒç”¨**ï¼šAIé©±åŠ¨çš„æ™ºèƒ½å·¥å…·é€‰æ‹©å’Œå‚æ•°ç”Ÿæˆ
- **å“åº”è§£æ**ï¼šè‡ªåŠ¨è§£æDeepSeekå“åº”ä¸­çš„å·¥å…·è°ƒç”¨
- **é”™è¯¯å¤„ç†**ï¼šæ™ºèƒ½çš„é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶

### å·¥ä½œæµè‡ªåŠ¨åŒ–
- **ä»»åŠ¡åˆ†è§£**ï¼šè‡ªåŠ¨å°†å¤æ‚ä»»åŠ¡åˆ†è§£ä¸ºå¯æ‰§è¡Œæ­¥éª¤
- **å¹¶è¡Œæ‰§è¡Œ**ï¼šæ”¯æŒå¤šå·¥å…·å¹¶è¡Œè°ƒç”¨
- **é”™è¯¯æ¢å¤**ï¼šæ™ºèƒ½é”™è¯¯å¤„ç†å’Œé‡è¯•æœºåˆ¶
- **çŠ¶æ€ç®¡ç†**ï¼šå®Œæ•´çš„æ™ºèƒ½ä½“çŠ¶æ€è·Ÿè¸ªå’Œæ¢å¤

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### æ–°æ¶æ„ï¼ˆç®€åŒ–ç‰ˆï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   DeepSeek API  â”‚    â”‚   Adapter        â”‚    â”‚  MCP Servers    â”‚
â”‚                 â”‚â—„â”€â”€â–ºâ”‚                  â”‚â—„â”€â”€â–ºâ”‚                 â”‚
â”‚ â€¢ HTTP Client   â”‚    â”‚ â€¢ Context Mgmt   â”‚    â”‚ â€¢ Memory        â”‚
â”‚ â€¢ Direct Call   â”‚    â”‚ â€¢ Config Source  â”‚    â”‚ â€¢ Payment       â”‚
â”‚ â€¢ Fast Response â”‚    â”‚ â€¢ State Mgmt     â”‚    â”‚ â€¢ Blockchain    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
                                â–¼
                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                       â”‚  Connection Pool â”‚
                       â”‚                  â”‚
                       â”‚ â€¢ Config Only    â”‚
                       â”‚ â€¢ MCP Discovery  â”‚
                       â”‚ â€¢ Server Mgmt    â”‚
                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ€§èƒ½æå‡
- **ä»£ç é‡å‡å°‘83%**ï¼šä»~1468è¡Œå‡å°‘åˆ°~240è¡Œ
- **å¯åŠ¨é€Ÿåº¦æå‡**ï¼šç§»é™¤å¤æ‚åˆå§‹åŒ–é€»è¾‘
- **å“åº”é€Ÿåº¦æå‡**ï¼šç›´æ¥HTTPè°ƒç”¨ï¼Œæ— ä¸­é—´å±‚
- **å†…å­˜ä½¿ç”¨ä¼˜åŒ–**ï¼šç®€åŒ–çŠ¶æ€ç®¡ç†

## ğŸ“¦ æ ¸å¿ƒç»„ä»¶

### æ™ºèƒ½ä½“ (Adapter)
### è¿æ¥æ±  (ConnectionPool)
### å·¥ä½œåŒºä¸Šä¸‹æ–‡ (WorkspaceContext)
## ğŸ› ï¸ ä½¿ç”¨æ–¹æ³•

### åŸºæœ¬ä½¿ç”¨
```rust
use alou::agent::{Adapter, AgentConfig, DeepSeekConfig, BehaviorConfig, WorkspaceConfig, ToolStrategy};

#[tokio::main]
async fn main() -> Result<(), Box<dyn std::error::Error>> {
    // åˆå§‹åŒ–æ—¥å¿—
    tracing_subscriber::fmt::init();
    
    // åˆ›å»ºæ™ºèƒ½ä½“é…ç½®
    let config = AgentConfig {
        deepseek: DeepSeekConfig {
            base_url: "https://api.deepseek.com".to_string(),
            api_key: std::env::var("DEEPSEEK_API_KEY")?,
            model: "deepseek-chat".to_string(),
            max_tokens: 2000,
            temperature: 0.7,
        },
        behavior: BehaviorConfig {
            max_retries: 3,
            timeout_seconds: 30,
            verbose_logging: true,
            tool_strategy: ToolStrategy::Auto,
        },
        workspace: WorkspaceConfig {
            directories: vec![".".to_string()],
            smart_detection: true,
            exclude_patterns: vec!["target".to_string(), "node_modules".to_string()],
        },
    };
    
    // åˆ›å»ºå¹¶åˆå§‹åŒ–é€‚é…å™¨
    let mut adapter = Adapter::new(config).await?;
    adapter.initialize().await?;
    
    // å¤„ç†ç”¨æˆ·è¾“å…¥
    let response = adapter.process_input("å¸®æˆ‘åˆ†æè¿™ä¸ªRusté¡¹ç›®çš„ä»£ç ç»“æ„").await?;
    println!("æ™ºèƒ½ä½“å“åº”: {}", response);
    
    Ok(())
}
```

### é«˜çº§é…ç½®
## ğŸ”§ ç¯å¢ƒé…ç½®

### é…ç½®æ–‡ä»¶
å¤åˆ¶ `config.example.json` ä¸º `agent_config.json` å¹¶å¡«å…¥æ‚¨çš„é…ç½®ï¼š

```bash
cp config.example.json agent_config.json
```

### ç¯å¢ƒå˜é‡
```bash
# DeepSeek APIé…ç½®
export DEEPSEEK_API_KEY="your-api-key-here"
export DEEPSEEK_BASE_URL="https://api.deepseek.com"  # å¯é€‰ï¼Œé»˜è®¤å€¼

# å·¥ä½œåŒºé…ç½®
export ALOU_WORKSPACE_DIRS="/path/to/project1,/path/to/project2"  # å¯é€‰

# æ—¥å¿—é…ç½®
export RUST_LOG="info"  # debug, info, warn, error
```

### é…ç½®ç¤ºä¾‹
```json
{
  "deepseek": {
    "base_url": "https://api.deepseek.com",
    "api_key": "your-deepseek-api-key-here",
    "model": "deepseek-chat",
    "max_tokens": 2000,
    "temperature": 0.7
  },
  "behavior": {
    "max_retries": 3,
    "timeout_seconds": 30,
    "verbose_logging": true,
    "tool_strategy": "Auto"
  },
  "workspace": {
    "directories": ["."],
    "smart_detection": true,
    "exclude_patterns": ["target", "node_modules"]
  }
}
```

### MCPæœåŠ¡å™¨é…ç½®
åˆ›å»º `mcp.json` é…ç½®æ–‡ä»¶ï¼š

#### Linux/macOS é…ç½®
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "/path/to/allowed/directory"
      ]
    },
    "memory": {
      "command": "npx",
      "args": [
        "-y",
        "@modelcontextprotocol/server-memory"
      ]
    }
  }
}
```

#### Windows é…ç½®
```json
{
  "mcpServers": {
    "filesystem": {
      "command": "npx.cmd",
      "args": [
        "-y",
        "@modelcontextprotocol/server-filesystem",
        "C:\\",
        "D:\\",
        "E:\\"
      ]
    },
    "memory": {
      "command": "npx.cmd",
      "args": [
        "-y",
        "@modelcontextprotocol/server-memory"
      ]
    }
  }
}
```

> **æ³¨æ„**ï¼šWindows ç³»ç»Ÿéœ€è¦ä½¿ç”¨ `npx.cmd` è€Œä¸æ˜¯ `npx`ï¼Œè¿™æ˜¯å› ä¸º Windows ä¸Šçš„ `npx` æ˜¯ PowerShell è„šæœ¬ï¼Œè€Œ MCP æœåŠ¡å™¨éœ€è¦ç›´æ¥å¯æ‰§è¡Œçš„æ‰¹å¤„ç†æ–‡ä»¶ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

1. **å…‹éš†é¡¹ç›®**
```bash
git clone https://github.com/logos-42/alou-rust.git
cd alou-rust
```

2. **å®‰è£…ä¾èµ–**
```bash
cargo build
```

3. **é…ç½®ç¯å¢ƒ**
```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.example.json agent_config.json

# ç¼–è¾‘é…ç½®æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„DeepSeek APIå¯†é’¥
# æˆ–è€…è®¾ç½®ç¯å¢ƒå˜é‡
export DEEPSEEK_API_KEY="your-api-key"
```

4. **è¿è¡Œç¤ºä¾‹**
```bash
# äº¤äº’å¼èŠå¤©æ¨¡å¼
cargo run --bin agent-cli chat

# æµ‹è¯•æ¨¡å¼
cargo run --bin agent-cli test --message "åˆ—å‡ºå½“å‰ç›®å½•å†…å®¹"

# æµ‹è¯•é€‚é…å™¨
cargo run --bin test_adapter --quiet test --message "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ çš„åŠŸèƒ½"

# é™é»˜æ¨¡å¼ï¼ˆå‡å°‘æ—¥å¿—è¾“å‡ºï¼‰
cargo run --bin agent-cli chat --quiet

# æ¸…æ´æ¨¡å¼ï¼ˆå®Œå…¨éšè—æŠ€æœ¯æ—¥å¿—ï¼‰
cargo run --bin agent-cli chat --clean
```

## ğŸ¯ åŠŸèƒ½æ¼”ç¤º

### åŸºæœ¬å·¥å…·è°ƒç”¨
```bash
# åˆ—å‡ºç›®å½•å†…å®¹
cargo run --bin agent-cli test --message "åˆ—å‡ºå½“å‰ç›®å½•çš„å†…å®¹"

# è®¿é—®ç‰¹å®šç›®å½•
cargo run --bin agent-cli test --message "åˆ—å‡ºD:\\AI\\Alou2ç›®å½•çš„å†…å®¹"

# æ–‡ä»¶æ“ä½œ
cargo run --bin agent-cli test --message "è¯»å–README.mdæ–‡ä»¶çš„å†…å®¹"
```

### æ™ºèƒ½æ¨ç†å’Œé—®é¢˜è§£å†³
æ™ºèƒ½ä½“èƒ½å¤Ÿï¼š
- è‡ªåŠ¨å‘ç°ç›®å½•åç§°å¤§å°å†™é—®é¢˜
- æ™ºèƒ½æ¨èæ­£ç¡®çš„è·¯å¾„
- æä¾›æ ¼å¼åŒ–çš„è¾“å‡ºç»“æœ
- å¤„ç†å¤šæ­¥éª¤ä»»åŠ¡

### åå°åŠ è½½ä¼˜åŒ–
- å¯åŠ¨æ—¶é™é»˜åŠ è½½ MCP æœåŠ¡å™¨
- ç”¨æˆ·é¦–æ¬¡è¾“å…¥æ—¶è‡ªåŠ¨å®Œæˆå·¥å…·å‘ç°
- æ”¯æŒå¤šç§æ—¥å¿—çº§åˆ«ï¼ˆæ­£å¸¸ã€é™é»˜ã€æ¸…æ´æ¨¡å¼ï¼‰

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

#### 1. MCP æœåŠ¡å™¨å¯åŠ¨å¤±è´¥
**é”™è¯¯ä¿¡æ¯**ï¼š`Failed to spawn process error=program not found`

**è§£å†³æ–¹æ¡ˆ**ï¼š
- **Windows ç”¨æˆ·**ï¼šç¡®ä¿ä½¿ç”¨ `npx.cmd` è€Œä¸æ˜¯ `npx`
- **æ£€æŸ¥ Node.js å®‰è£…**ï¼šè¿è¡Œ `node --version` å’Œ `npm --version`
- **æ£€æŸ¥ PATH ç¯å¢ƒå˜é‡**ï¼šç¡®ä¿ npm å…¨å±€åŒ…è·¯å¾„åœ¨ PATH ä¸­

#### 2. å·¥å…·è°ƒç”¨ä¸æ‰§è¡Œ
**ç—‡çŠ¶**ï¼šæ™ºèƒ½ä½“æ˜¾ç¤ºå·¥å…·è°ƒç”¨ JSON ä½†ä¸æ‰§è¡Œ

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ç¡®ä¿ DeepSeek API å¯†é’¥æ­£ç¡®é…ç½®
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- æŸ¥çœ‹æ—¥å¿—è¾“å‡ºä¸­çš„é”™è¯¯ä¿¡æ¯

#### 3. ç›®å½•è®¿é—®æƒé™é—®é¢˜
**é”™è¯¯ä¿¡æ¯**ï¼š`Access denied` æˆ–ç›®å½•ä¸åœ¨å…è®¸åˆ—è¡¨ä¸­

**è§£å†³æ–¹æ¡ˆ**ï¼š
- åœ¨ `mcp.json` ä¸­æ·»åŠ å…è®¸è®¿é—®çš„ç›®å½•è·¯å¾„
- ç¡®ä¿è·¯å¾„æ ¼å¼æ­£ç¡®ï¼ˆWindows ä½¿ç”¨ `\\`ï¼ŒLinux/macOS ä½¿ç”¨ `/`ï¼‰
- æ£€æŸ¥æ–‡ä»¶ç³»ç»Ÿæƒé™

#### 4. å¯åŠ¨é€Ÿåº¦æ…¢
**ç—‡çŠ¶**ï¼šåº”ç”¨å¯åŠ¨æ—¶é—´è¿‡é•¿

**è§£å†³æ–¹æ¡ˆ**ï¼š
- ä½¿ç”¨ `--quiet` æˆ– `--clean` æ¨¡å¼å‡å°‘æ—¥å¿—è¾“å‡º
- åå°åŠ è½½åŠŸèƒ½ä¼šè‡ªåŠ¨ä¼˜åŒ–å¯åŠ¨é€Ÿåº¦
- æ£€æŸ¥ç½‘ç»œè¿æ¥å’Œ MCP æœåŠ¡å™¨å“åº”æ—¶é—´

### è°ƒè¯•æ¨¡å¼

å¯ç”¨è¯¦ç»†æ—¥å¿—è¾“å‡ºï¼š
```bash
export RUST_LOG=debug
cargo run --bin agent-cli chat
```

## ğŸ“š APIæ–‡æ¡£

### æ ¸å¿ƒç±»å‹

- `McpAgent`: ä¸»è¦çš„æ™ºèƒ½ä½“å®ç°
- `AgentConfig`: æ™ºèƒ½ä½“é…ç½®ç»“æ„
- `ConnectionPool`: MCPæœåŠ¡å™¨è¿æ¥æ± 
- `WorkspaceContext`: å·¥ä½œåŒºä¸Šä¸‹æ–‡ç®¡ç†
- `ToolInfo`: å·¥å…·ä¿¡æ¯ç»“æ„

### ä¸»è¦æ–¹æ³•

- `McpAgent::new()`: åˆ›å»ºæ–°çš„æ™ºèƒ½ä½“å®ä¾‹
- `McpAgent::initialize()`: åˆå§‹åŒ–æ™ºèƒ½ä½“ï¼ˆåŒ…å«åå°MCPæœåŠ¡å™¨åŠ è½½ï¼‰
- `McpAgent::process_input()`: å¤„ç†ç”¨æˆ·è¾“å…¥ï¼ˆæ”¯æŒå·¥å…·è°ƒç”¨è§£æå’Œæ‰§è¡Œï¼‰
- `McpAgent::execute_tool()`: æ‰§è¡Œå·¥å…·è°ƒç”¨
- `McpAgent::discover_tools_silent()`: é™é»˜å‘ç°å¯ç”¨å·¥å…·
- `ConnectionPool::get_connection()`: è·å–MCPæœåŠ¡å™¨è¿æ¥
- `ConnectionPool::list_registered_servers()`: åˆ—å‡ºå·²æ³¨å†Œçš„æœåŠ¡å™¨

## Contributing

Contributions are welcome! Please open an issue or submit a PR if you have improvements, bug fixes, or new features to propose.

1. Fork the repo
2. Create a new branch
3. Add your changes and tests
4. Submit a Pull Request

Please @ darinkishore in the PR if you do send one over.

### Credits

- [MCP Rust SDK](https://github.com/Derek-X-Wang/mcp-rust-sdk)
- [AIchat](https://github.com/sigoden/aichat/tree/main)

### License

This project is licensed under the MIT License. See [LICENSE](LICENSE) for details.
